!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.fetchObservable=t():e.fetchObservable=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return"string"==typeof e}function i(e){return"function"==typeof e}function s(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=t.refreshDelay,n=void 0===r?!1:r,s=[],u=null,a=!1,c=0;(a=o(e))&&(e=[e]);var l=function p(){if(0!==s.length&&!h.paused()){var r=function(){n?u=setTimeout(p,i(n)?n(c++):n):(h.pause(),s.map(function(e){return e.complete()}),s=[])},o=e.map(function(e){return fetch(e,t)});Promise.all(o).then(function(e){s.map(function(t){return t.next(a?e[0]:e)}),r()})["catch"](function(e){s.map(function(t){return t.error(a?e[0]:e)}),r()})}},h=new f["default"](function(e){return s.push(e),s.length&&h.resume(),function(){s.splice(s.indexOf(e),1),s.length||h.pause()}},{onPause:function(){u&&(clearTimeout(u),u=null)},onResume:function(){u||l()}});return h.resume(),h}Object.defineProperty(t,"__esModule",{value:!0});var u=r(3),a=(n(u),r(2)),f=n(a);t["default"]=s},function(e,t,r){(function(e,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function i(e){Symbol[e]||Object.defineProperty(Symbol,e,{value:Symbol(e)})}function s(e){return Object.getOwnPropertyNames(e).forEach(function(t){Object.defineProperty(e,t,{enumerable:!1})}),e}function u(e,t){var r=e[t];if(null!=r){if("function"!=typeof r)throw new TypeError(r+" is not a function");return r}}function a(e){var t=e._cleanup;t&&(e._cleanup=void 0,t())}function f(e){return void 0===e._observer}function c(e){f(e)||(e._observer=void 0,a(e))}function l(e){return function(t){e.unsubscribe()}}function h(e,t){if(Object(e)!==e)throw new TypeError("Observer must be an object");var r=new p(e),n=new d(r),o=u(e,"start");if(o&&o.call(e,n),f(r))return n;try{var i=t.call(void 0,r);if(null!=i){if("function"==typeof i.unsubscribe)i=l(i);else if("function"!=typeof i)throw new TypeError(i+" is not a function");r._cleanup=i}}catch(s){return r.error(s),n}return f(r)&&a(r),n}function p(e){this._observer=e,this._cleanup=void 0}function d(e){this._observer=e}var y=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Object.defineProperty(t,"__esModule",{value:!0});var b=function(){if("undefined"!=typeof e&&"undefined"!=typeof r&&r.nextTick)return e.setImmediate?function(t){e.setImmediate(t)}:function(e){r.nextTick(e)};var t=self.MutationObserver||self.WebKitMutationObserver;if(t){var n=function(){var e=document.createElement("div"),r=function(t){return e.classList.toggle("x")},n=[],o=new t(function(e){for(n.length>1&&r();n.length>0;)n.shift()()});return o.observe(e,{attributes:!0}),{v:function(e){n.push(e),1===n.length&&r()}}}();if("object"===("undefined"==typeof n?"undefined":o(n)))return n.v}return function(e){setTimeout(e,0)}}();i("observable"),p.prototype=s({get closed(){return f(this)},next:function(e){if(!f(this)){var t=this._observer;try{var r=u(t,"next");if(!r)return;return r.call(t,e)}catch(n){try{c(this)}finally{throw n}}}},error:function(e){if(f(this))throw e;var t=this._observer;this._observer=void 0;try{var r=u(t,"error");if(!r)throw e;e=r.call(t,e)}catch(n){try{a(this)}finally{throw n}}return a(this),e},complete:function(e){if(!f(this)){var t=this._observer;this._observer=void 0;try{var r=u(t,"complete");e=r?r.call(t,e):void 0}catch(n){try{a(this)}finally{throw n}}return a(this),e}}}),d.prototype=s({unsubscribe:function(){c(this._observer)}});t.Observable=function(){function e(t){if(n(this,e),"function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}return y(e,[{key:"subscribe",value:function(e){return h(e,this._subscriber)}},{key:"forEach",value:function(e){var t=this;return new Promise(function(r,n){if("function"!=typeof e)throw new TypeError(e+" is not a function");t.subscribe({next:function(t){try{return e(t)}catch(r){n(r)}},error:n,complete:r})})}},{key:Symbol.observable,value:function(){return this}}],[{key:"from",value:function(t){var r="function"==typeof this?this:e;if(null==t)throw new TypeError(t+" is not an object");var n=u(t,Symbol.observable);if(n){var i=function(){var e=n.call(t);if(Object(e)!==e)throw new TypeError(e+" is not an object");return e.constructor===r?{v:e}:{v:new r(function(t){return e.subscribe(t)})}}();if("object"===("undefined"==typeof i?"undefined":o(i)))return i.v}return new r(function(e){b(function(r){if(!e.closed){try{var n=!0,o=!1,i=void 0;try{for(var s,u=t[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var a=s.value;if(e.next(a),e.closed)return}}catch(f){o=!0,i=f}finally{try{!n&&u["return"]&&u["return"]()}finally{if(o)throw i}}}catch(c){return void e.error(c)}e.complete()}})})}},{key:"of",value:function(){for(var t=arguments.length,r=Array(t),n=0;t>n;n++)r[n]=arguments[n];var o="function"==typeof this?this:e;return new o(function(e){b(function(t){if(!e.closed){for(var n=0;n<r.length;++n)if(e.next(r[n]),e.closed)return;e.complete()}})})}},{key:Symbol.species,get:function(){return this}}]),e}()}).call(t,function(){return this}(),r(4))},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function c(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:c(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)};Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),f=function(e){function t(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];n(this,t);var i=o(this,Object.getPrototypeOf(t).call(this,e));return i.options=r,i.state="paused",i}return i(t,e),s(t,[{key:"pause",value:function(){if(this.state="paused",this.options.onPause){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.options.onPause.apply(this,t)}return this}},{key:"resume",value:function(){if(this.state="resumed",this.options.onResume){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.options.onResume.apply(this,t)}return this}},{key:"paused",value:function(){return"paused"===this.state}},{key:"subscribe",value:function(e){var r=u(Object.getPrototypeOf(t.prototype),"subscribe",this).call(this,e),n=this;return r.active=function(){return void 0!==this._observer&&!n.paused()},r.resubscribe=function(){return this.active()?!1:n.subscribe(e)},r}}]),t}(a.Observable);t["default"]=f},function(e,t,r){r(5),e.exports=self.fetch.bind(self)},function(e,t){function r(){f=!1,s.length?a=s.concat(a):c=-1,a.length&&n()}function n(){if(!f){var e=setTimeout(r);f=!0;for(var t=a.length;t;){for(s=a,a=[];++c<t;)s&&s[c].run();c=-1,t=a.length}s=null,f=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function i(){}var s,u=e.exports={},a=[],f=!1,c=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];a.push(new o(e,t)),1!==a.length||f||setTimeout(n,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=i,u.addListener=i,u.once=i,u.off=i,u.removeListener=i,u.removeAllListeners=i,u.emit=i,u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t){!function(){"use strict";function e(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function t(e){return"string"!=typeof e&&(e=String(e)),e}function r(e){this.map={},e instanceof r?e.forEach(function(e,t){this.append(t,e)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function n(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function o(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function i(e){var t=new FileReader;return t.readAsArrayBuffer(e),o(t)}function s(e){var t=new FileReader;return t.readAsText(e),o(t)}function u(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,"string"==typeof e)this._bodyText=e;else if(p.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(p.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(e){if(!p.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e))throw new Error("unsupported BodyInit type")}else this._bodyText=""},p.blob?(this.blob=function(){var e=n(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(i)},this.text=function(){var e=n(this);if(e)return e;if(this._bodyBlob)return s(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var e=n(this);return e?e:Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(c)}),this.json=function(){return this.text().then(JSON.parse)},this}function a(e){var t=e.toUpperCase();return d.indexOf(t)>-1?t:e}function f(e,t){t=t||{};var n=t.body;if(f.prototype.isPrototypeOf(e)){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new r(e.headers)),this.method=e.method,this.mode=e.mode,n||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=e;if(this.credentials=t.credentials||this.credentials||"omit",(t.headers||!this.headers)&&(this.headers=new r(t.headers)),this.method=a(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function c(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}}),t}function l(e){var t=new r,n=e.getAllResponseHeaders().trim().split("\n");return n.forEach(function(e){var r=e.trim().split(":"),n=r.shift().trim(),o=r.join(":").trim();t.append(n,o)}),t}function h(e,t){t||(t={}),this._initBody(e),this.type="default",this.status=t.status,this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText,this.headers=t.headers instanceof r?t.headers:new r(t.headers),this.url=t.url||""}if(!self.fetch){r.prototype.append=function(r,n){r=e(r),n=t(n);var o=this.map[r];o||(o=[],this.map[r]=o),o.push(n)},r.prototype["delete"]=function(t){delete this.map[e(t)]},r.prototype.get=function(t){var r=this.map[e(t)];return r?r[0]:null},r.prototype.getAll=function(t){return this.map[e(t)]||[]},r.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},r.prototype.set=function(r,n){this.map[e(r)]=[t(n)]},r.prototype.forEach=function(e,t){Object.getOwnPropertyNames(this.map).forEach(function(r){this.map[r].forEach(function(n){e.call(t,n,r,this)},this)},this)};var p={blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self},d=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];f.prototype.clone=function(){return new f(this)},u.call(f.prototype),u.call(h.prototype),h.prototype.clone=function(){return new h(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new r(this.headers),url:this.url})},h.error=function(){var e=new h(null,{status:0,statusText:""});return e.type="error",e};var y=[301,302,303,307,308];h.redirect=function(e,t){if(-1===y.indexOf(t))throw new RangeError("Invalid status code");return new h(null,{status:t,headers:{location:e}})},self.Headers=r,self.Request=f,self.Response=h,self.fetch=function(e,t){return new Promise(function(r,n){function o(){return"responseURL"in s?s.responseURL:/^X-Request-URL:/m.test(s.getAllResponseHeaders())?s.getResponseHeader("X-Request-URL"):void 0}var i;i=f.prototype.isPrototypeOf(e)&&!t?e:new f(e,t);var s=new XMLHttpRequest;s.onload=function(){var e=1223===s.status?204:s.status;if(100>e||e>599)return void n(new TypeError("Network request failed"));var t={status:e,statusText:s.statusText,headers:l(s),url:o()},i="response"in s?s.response:s.responseText;r(new h(i,t))},s.onerror=function(){n(new TypeError("Network request failed"))},s.open(i.method,i.url,!0),"include"===i.credentials&&(s.withCredentials=!0),"responseType"in s&&p.blob&&(s.responseType="blob"),i.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send("undefined"==typeof i._bodyInit?null:i._bodyInit)})},self.fetch.polyfill=!0}}()}])});